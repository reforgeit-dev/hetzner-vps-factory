---
# Ubuntu upgrade playbook
# Run separately from main site.yml as it requires reboot
#
# Usage:
#   ansible-playbook -i inventory.ini playbooks/upgrade.yml
#
# Steps through intermediate releases automatically (e.g., 24.04 -> 24.10 -> 25.04 -> 25.10)
# via a self-rebooting systemd service. Single run handles the full upgrade path.

- name: Upgrade Ubuntu
  hosts: hetzner_vps
  gather_facts: false
  become: true

  pre_tasks:
    - name: Wait for connection
      wait_for_connection:
        timeout: 300

  roles:
    - role: upgrade
      tags: [upgrade]

  post_tasks:
    - name: Show final version
      raw: lsb_release -a
      changed_when: false
